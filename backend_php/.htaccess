RewriteEngine On
RewriteBase /api/

# Handle CORS (wrapped in IfModule for compatibility)
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
  Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
</IfModule>

# Handle Options method
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ - [R=200,L]

# Remove .php extension
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [L]

# Routing for Projects
# GET projects/123 -> projects/read_one.php?id=123
RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^projects/([0-9]+)$ projects/read_one.php?id=$1 [L,QSA]

# PUT projects/123 -> projects/update.php?id=123
RewriteCond %{REQUEST_METHOD} PUT [OR]
RewriteCond %{REQUEST_METHOD} POST
RewriteRule ^projects/([0-9]+)$ projects/update.php?id=$1 [L,QSA]

# DELETE projects/123 -> projects/delete.php?id=123
RewriteCond %{REQUEST_METHOD} DELETE
RewriteRule ^projects/([0-9]+)$ projects/delete.php?id=$1 [L,QSA]

# Routing for Careers
# GET careers/123 -> careers/read_one.php?id=123
RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^careers/([0-9]+)$ careers/read_one.php?id=$1 [L,QSA]

# PUT careers/123 -> careers/update.php?id=123
RewriteCond %{REQUEST_METHOD} PUT
RewriteRule ^careers/([0-9]+)$ careers/update.php?id=$1 [L,QSA]

# DELETE careers/123 -> careers/delete.php?id=123
RewriteCond %{REQUEST_METHOD} DELETE
RewriteRule ^careers/([0-9]+)$ careers/delete.php?id=$1 [L,QSA]

# Routing for Applications
RewriteCond %{REQUEST_METHOD} PUT
RewriteRule ^applications/([0-9]+)$ applications/update.php?id=$1 [L,QSA]

RewriteCond %{REQUEST_METHOD} DELETE
RewriteRule ^applications/([0-9]+)$ applications/delete.php?id=$1 [L,QSA]

