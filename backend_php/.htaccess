RewriteEngine On
RewriteBase /api/

# Handle CORS (wrapped in IfModule for compatibility)
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
  Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
</IfModule>

# Handle Options method
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ - [R=204,L]

# Auth routes
RewriteRule ^auth/login$ api/auth/login.php [L,QSA]

# Projects routes
RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^projects$ api/projects/read.php [L,QSA]

RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^projects/([0-9]+)$ api/projects/read_one.php?id=$1 [L,QSA]

RewriteCond %{REQUEST_METHOD} POST
RewriteRule ^projects$ api/projects/create.php [L,QSA]

RewriteCond %{REQUEST_METHOD} PUT
RewriteRule ^projects/([0-9]+)$ api/projects/update.php?id=$1 [L,QSA]

RewriteCond %{REQUEST_METHOD} DELETE
RewriteRule ^projects/([0-9]+)$ api/projects/delete.php?id=$1 [L,QSA]

# Careers routes
RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^careers$ api/careers/read.php [L,QSA]

RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^careers/([0-9]+)$ api/careers/read_one.php?id=$1 [L,QSA]

RewriteCond %{REQUEST_METHOD} POST
RewriteRule ^careers$ api/careers/create.php [L,QSA]

RewriteCond %{REQUEST_METHOD} PUT
RewriteRule ^careers/([0-9]+)$ api/careers/update.php?id=$1 [L,QSA]

RewriteCond %{REQUEST_METHOD} DELETE
RewriteRule ^careers/([0-9]+)$ api/careers/delete.php?id=$1 [L,QSA]

# Applications
RewriteCond %{REQUEST_METHOD} POST
RewriteRule ^applications$ api/applications/create.php [L,QSA]

RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^applications$ api/applications/read.php [L,QSA]

RewriteCond %{REQUEST_METHOD} DELETE
RewriteRule ^applications/([0-9]+)$ api/applications/delete.php?id=$1 [L,QSA]

